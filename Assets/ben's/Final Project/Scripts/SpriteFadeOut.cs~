using UnityEngine;
using System.Collections;

public class SpriteFadeOut : MonoBehaviour
{
	public float fadeDuration = 0.5f;

	SpriteRenderer sr;
	Coroutine fadeRoutine;

	void Awake()
	{
		sr = GetComponent<SpriteRenderer>();
	}

	public void FadeOut()
	{
		if (fadeRoutine != null)
			StopCoroutine(fadeRoutine);

		fadeRoutine = StartCoroutine(FadeOutRoutine());
	}

	IEnumerator FadeOutRoutine()
	{
		float t = 0f;
		Color startColor = sr.color;

		while (t < fadeDuration)
		{
			t += Time.deltaTime;
			float alpha = Mathf.Lerp(1f, 0f, t / fadeDuration);

			sr.color = new Color(
				startColor.r,
				startColor.g,
				startColor.b,
				alpha
			);

			yield return null;
		}

		sr.color = new Color(startColor.r, startColor.g, startColor.b, 0f);
	}
}